# Keycloak Server Configuration
# This file contains server configuration that complements environment variables

# Database Configuration
db=mariadb
db-url=jdbc:mariadb://mariadb:3306/keycloak?characterEncoding=UTF-8
db-username=${KC_DB_USERNAME}
db-password=${KC_DB_PASSWORD}
db-pool-initial-size=5
db-pool-max-size=20
db-pool-min-size=5

# HTTP/HTTPS Configuration
http-enabled=true
http-port=8080
hostname=${KC_HOSTNAME}
hostname-port=${KC_HOSTNAME_PORT}
hostname-strict=false
hostname-strict-https=false

# Proxy Configuration (uncomment if behind reverse proxy)
# proxy=edge
# proxy-headers=forwarded

# Cache Configuration
cache=ispn
cache-stack=tcp
cache-config-file=cache-ispn.xml

# Logging Configuration
log=console
log-level=${KC_LOG_LEVEL}
log-console-color=true

# Metrics and Health Configuration
health-enabled=true
metrics-enabled=true

# Security Configuration
# For production, enable HTTPS and disable HTTP
# https-certificate-file=/opt/keycloak/conf/server.crt.pem
# https-certificate-key-file=/opt/keycloak/conf/server.key.pem
# http-enabled=false

# Transaction Configuration
transaction-xa-enabled=false

# Feature Configuration
# Enable/disable specific features as needed
features=token-exchange,admin-fine-grained-authz

# Development vs Production Settings
# For development (current setting)
# Remove for production deployment
hostname-strict-backchannel=false